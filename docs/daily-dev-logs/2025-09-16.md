# 2025-09-16 작업 기록

## 서버 & 인프라

- `server/` 디렉터리 신설 후 `express-generator`로 기본 골격 생성, `npm install`로 의존성 정리.
- `database/db_connect.js`에서 `mysql` 드라이버와 `.env` 환경 변수(`DB_PASSWORD`)를 사용해 MariaDB(`localhost:3307`, `taxi` 스키마) 연결 구성.
- Firebase Admin SDK 초기화(`call-taxi-ServiceAccountKey.json`) 및 `.gitignore` 반영, `.env-example.md`로 필요한 환경 변수 가이드 작성.

## REST API 구현

- 패신저용 `/taxi/register`, `/taxi/login`, `/taxi/list`, `/taxi/call` 엔드포인트 작성.
  - 회원 가입 시 FCM 토큰 저장, 중복 ID 검사.
  - 로그인 성공 시 FCM 토큰 갱신.
  - 콜 생성 시 `tb_call`에 저장하고 모든 드라이버에게 푸시 토큰 조회 후 알림 발송.
- 드라이버용 `/driver/login`, `/driver/list`, `/driver/accept` 엔드포인트 작성.
  - `RES` 상태 업데이트 시 해당 사용자에게 FCM 푸시 발송.
- 공통 유틸로 `updateFCM`, `sendPushToAlldriver`, `sendPushToUser`, `sendFcm` 작성해 토큰 관리 및 알림 전송 로직 정리.

## 프론트엔드 연동

- `taxiApp/src/API.tsx`에서 Axios 인스턴스 생성(`baseURL`, 타임아웃) 후 테스트/로그인/회원가입/콜 목록 API 래핑.
- `Login.tsx`, `Register.tsx`, `Main_List.tsx`에 API 호출 로직 연결.
  - 로그인/회원가입/목록 조회 성공/실패 분기 및 Alert 처리.
  - `Main_List`는 `useFocusEffect` + `RefreshControl` 조합으로 자동 새로고침과 로딩 모달 지원.
- `Main_Map.tsx`에 Google Maps 기반 화면 초안 배치, 롱프레스 UI 토글 등 기본 상호작용 준비.

## 지도 API & Android 빌드 설정

- `android/app/build.gradle`을 `plugins {}` 방식으로 이관하고 Google Secrets Gradle Plugin 정식 추가.
- `android/local.defaults.properties`에 `MAPS_API_KEY` 기본값 정의, `AndroidManifest.xml`에서는 `${MAPS_API_KEY}` 플레이스홀더 사용.
- `AndroidManifest.xml`에 Google Maps 메타데이터 추가, `react-native-maps` 설치 기록.

## 특이 사항 / TODO

- 서버 `.env`에 `DB_PASSWORD` 설정 필요, Firebase 서비스 계정 키는 로컬 안전 보관.
- Axios `baseURL`은 개발자 PC IPv4 주소로 설정되어 있어 환경별 값 관리 방식 논의 필요.
- 지도 화면은 아직 실시간 위치/마커 저장 미구현, 추후 API 연동 시 확장 예정.
